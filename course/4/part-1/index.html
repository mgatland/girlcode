<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Girl Code activities</title>

    <!-- Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/freelancer.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <link href="/js/prism/prism.css" rel="stylesheet">
    <script src="/js/prism/prism.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" class="index">

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5JFL8D"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5JFL8D');</script>
    <!-- End Google Tag Manager -->

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Girl Code</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll">
                        <a href="../">Node.js</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="intro-text">
                        <span class="name">Life on the server-side</span>
                        <span class="skills">With Node.js</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <section id="starter">
        <div class="container codeclubstyle">
            <div class="row">
                <div class="col-lg-12">

      <!-- insert legacy Code Club content here -->
      <h1>Servers</h1>

      <p>All our code so far has been client-side code. This means it is downloaded onto the user's computer, and makes things appear or happen on the user's computer.</p>

      <p>If we want to do things outside of the user's computer – like post messages for other people to read on other computers – we need to run code on the server, the computer that the website comes from.</p>

      <p>In this workshop we will set up a server using Node.js which will serve files to a client.</p>

      <h2>Setting up Node.js</h2>

      <p>Node.js (sometimes just called Node) is a server program.</p>

      <p><a href="https://nodejs.org/download/" target="_blank">Download Node</a> (choose the Windows installer or Macintosh installer) and install it. (Basically just click 'next' on all the pages, you don't need to change any settings.)</p>

      <h2>Terminal and Command Prompt</h2>

      <p>Have you heard of the 'command line?' It's a place in your computer where you type in commands, and it was very popular until Windows came out in 1992.</p>

      <p>But the command line is still in your computer! It's been waiting for you all these years…</p>

      <h2>Find it on Windows</h2>

      <img src="cmd.png">

      <p>Press the Start button, type in "cmd" and <b>Command Prompt</b> will come up. Click on Command Prompt to start.</p>

      <h2>Find it on Mac</h2>

      <img src="terminal.png">

      <p>Open Finder, go to Applications, look in the Utilities folder and open 'Terminal'.</p>

      <h2>Change the color scheme</h2>

      <p>Black and white is so 90s. Change your color scheme:</p>

      <img src="cmd-colours.gif">

      <img src="terminal-colours.gif">

      <h2>Command line commands</h2>

      <p>The command line is a lot like Finder (on Mac) or Windows Explorer. You can move from folder to folder. You can run things in the folder you are in.</p>

      <h3>What folder am I in?</h3>

      <p><b>Windows</b>: the Command Prompt always says what folder you are in.</p>

      <p><b>Mac</b>: To check where you are, type <code>pwd</code> and hit Enter. (It's short for 'print working directory'. 'Working Directory' means the folder you are in. Print means write on the screen, not on paper!</p>

      <h3>What is in this folder?</h3>

      <p><b>Windows</b>: type <code>dir</code> and hit Enter. (It's short for 'directory', which is the old word for folder.)</p>

      <p><b>Mac</b>: type <code>ls</code> and hit Enter. (It's kind of short for 'list files'.</p>

      <h3>How do I go into a different folder?</h3>

      <p>Type <code>cd something</code> where 'something' is the name of the folder you want to move into. This lets you go down into folders inside the current working folder.</p>

      <p><code>cd</code> is short for 'change directory'. (Directory is the old word for 'folder'.)</p>

      <div class="alert">

        <p>Protip 1: If the folder name has a space in it, you need to put speech marks around the whole name. This is so the command line knows that the two words are joined together. For example: <code>cd "My Documents"</code></p>

        <p>Protip 2: On the Mac, capital letters matter! <code>cd Downloads</code> is not <code>cd downloads</code>. Windows doesn't care about capital letters.</p>
      </div>

      <p>To go up to the parent folder, type <code>cd ..</code> (that is cd, a space, then two dots)</p>

      <p>That's enough command line stuff for now.</p>

      <h2>Get our Node project</h2>

      <p>Go to this <a href="https://github.com/mgatland/nodestart/" target="_blank">webpage</a> where Matthew put a simple Node project. Click on 'Clone in Desktop' </p>

      <p>This will create a clone (a copy) of the project on your computer. <b>Keep a note of where on your computer it was created!</b></p>

      <p>Now, using your new Terminal or Command Prompt skills, change your working folder to be the <b>nodestart</b> folder that was just created.</p>

      <p>You'll need to use lots of <code>cd</code> commands to get there.</p>

      <p>Once you get there, type <code>dir</code> (Windows) or <code>ls</code> (Mac) and you should see a list of files including <b>index.js</b>.</p>

      <div class="alert">
        <p><b>Protip:</b> If you want to get to the right folder more quickly next time, just right click on the project name in Github Desktop and choose 'Open in Terminal' or 'Open in Command Prompt'</p>
        <img src="open-in-terminal.png">

        <p>This will open a Terminal or Command Prompt that is already in the right folder.</p>
      </div>

      <h2>Running Node</h2>

      <p>So you should now have Terminal or Command Prompt open, and have moved to the nodestart folder.</p>

      <p>To install the dependencies - all the things our program needs to work right - type <code>npm install</code> into Terminal\Command Prompt and hit enter. It may take a while to finish.</p>

      <p>(How does it know what to install? It has a shopping list in the file package.json. Feel free to take a look. They're listed as 'dependencies'.)</p>

      <p>Next, run our Node app by typing <code>node index.js</code> and hitting enter.</p>

      <p>Your Terminal\Command Prompt is now busy running the server - it won't listen to any more instructions from you.</p>

      <p>This starts up a <b>server</b> on your computer. Open your favourite web browser (we like Google Chrome) and go to <a href="http://localhost:3000/index.html" target="_blank">http://localhost:3000/index.html</a> to visit your local server.</p>

      <p>If you see an orange and purple page, it's working!</p>

      <h2>Serving Files</h2>

      <p>This server program is very simple. When we ask for a file, it looks in the 'nodestart/public' folder for that file. If it's there, it sends the file to us.</p>

      <p>The public folder is inside your nodestart folder. Use Windows Explorer or Finder (Mac) to look inside the public folder and see what's there.</p>

        <h2>Serve another File</h2>     

        <p>Remember how we installed Atom a few weeks ago? Open Atom. It's a text editor. Use Atom to make a new file, and save it as in the 'nodestart/public' folder with the file name <b>new.html</b>.</p>

        <p>using Atom, put this code inside new.html and save it again.</p>

      <pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
  &lt;/head>
  &lt;body>
     <h1>Hi i am a new page I guess</h1>
     <h2>not gonna brag <br> but i'm pretty cool</h2>
  &lt;/body>
&lt;/html>
      </code></pre>


      <p>Now our server will automatically serve this page too, if we ask for it. Click this link to ask for the new page:</p>

      <p><a href="http://localhost:3000/new.html" target="_blank">http://localhost:3000/new.html</a></p>

     <p>What happens if you ask for something that's not in the public folder?</p>

      <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

      <p>The server says "I can't GET that page for you".</p>

      <h2>Our server is clever</h2>

      <p>It's easy to serve pages that have already been made! But sites like Facebook, pinterest and TradeMe serve us special pages that are always changing – pages that update and change all the time.</p>

      <p>Let's tell our server, when we make a special request, it should give us a special reply - not just a premade page.</p>

      <h2>The server's instructions</h2>

      <p>Use Atom to open <b>index.js</b>, a file in the  in the main <b>nodestart folder</b>. Note that this is not in the <b>public</b> folder, it's in the folder above the public folder.</p>

      <p>This is a <b>js</b> file, which means JavaScript. There are 5 lines of code, plus some comments (lines that start with // are comments for humans to read, the computer does not read them.)</p>

      <p>Your code will look exactly the same as this:</p>

      <pre><code class="language-javascript">
//set up
var express = require('express')
var app = express();

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

//listen for connections on port 3000
app.listen(3000);
console.log("I am listening...");
      </code></pre>

      <p><b>We don't need to understand all of those commands today</b>. The main thing to know is, when you make a request, it looks in the public folder for a file to give you. If there is no matching file, it tells you it cannot GET that file.</p>

      <h2>Special requests</h2>

      <p>Add this code at line 8 of your index.js file:</p>

      <pre><code class="language-javascript">
var coolIdeas = [];
coolIdeas.push("Two cats who solve crimes in Dunedin");

var sendIdeasList = function (request, response) {
  response.send(coolIdeas);
}
app.get('/ideas', sendIdeasList);
        </code></pre>

        <p>This tells the server: When someone makes a GET request for "/ideas", use the code in the fuction <code>sendIdeasList</code> to reply. That code sends them the list 'coolIdeas', which currently contains one item.</p>

        <p>Now:</p>

        <ul>
            <li>Save your changes.</li> 
            <li>Go to the Command Prompt\Terminal and hit Ctrl-C, Ctrl-C (twice) to <b>stop</b> the server.</li>
            <li>Then start the server again by typing <code>node index.js</code>, Enter.</li>
            <li>This will make the server read your updated instructions, and start serving with the new rules.</li>
        </ul>

        <p>Now try this link again:</p>

        <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

        <p>This time, you should get the special response.</p>

        <p><b>protip</b>: the response isn't very pretty! It's just a list on plain white background. This is because it's not really made for looking at.</p>

        <p>Normally, a human wouldn't GET a list like this. Instead, the web browser would GET it behind the scenes, and use it to build something that looks nice.</p>

      <h2>GET and POST</h2>

      <p>When the user wants to look at a web page, that's called GET.</p>

      <p>When the user wants to change or save something, like a new facebook message, that's called POST. They POST the message to the server, like a letter 📩</p>

      <p><b>Delete ALL the code in index.js</b> and replace it with this. I've changed it, so that the server lets clients add ideas to a list. (Remember lists from our TV Show Idea Generator?)</p>

      <pre><code class="language-javascript">
//set up
var express = require('express')
var app = express();
var bodyParser = require('body-parser')

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

//this lets us read POST data
app.use(bodyParser.urlencoded({ extended: false }))
app.use(bodyParser.json())

//make an empty list of ideas
var coolIdeas = [];
coolIdeas.push("A family who are all secretly superheroes but haven't told each other"); 

//let a client GET the list of ideas
var sendIdeasList = function (request, response) {
  response.send(coolIdeas);
}
app.get('/ideas', sendIdeasList);

//let a client POST new ideas
var saveNewIdea = function (request, response) {
  console.log(request.body.idea); //write it on the command prompt so we can see
  coolIdeas.push(request.body.idea); //save it in our list
  response.send("thanks for your idea. Press back to add another");
}
app.post('/ideas', saveNewIdea);

//listen for connections on port 3000
app.listen(3000);
console.log("I am listening...");

      </code></pre>

        <p>Because we changed the server instructions, we need to:</p>

        <ul>
            <li>Save your changes.</li> 
            <li>Go to the Command Prompt\Terminal and hit Ctrl-C, Ctrl-C (twice) to <b>stop</b> the server.</li>
            <li>Then start the server again by typing <code>node index.js</code>, Enter.</li>
        </ul>

    <p>You can test the GET by using the same link as before.</p>

    <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

    <p>Testing POST is trickier because your web browser does not normally POST.</p>

    <p>To post, we need a page with a button on it. Use Atom to make a new file called <b>test.html</b> and save it in your <b>public</b> folder. Put this code inside:</p>

<pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
  &lt;/head>
  &lt;body>
      &lt;form method="post" action="/ideas">
          &lt;input type="text" name="idea" value="idea goes here">
          &lt;input type="submit" value="Submit">
      &lt;/form>
  &lt;/body>
&lt;/html>
</code></pre>

    <p>Now if you go to that page (<a href="http://localhost:3000/test.html" target="_blank">http://localhost:3000/test.html</a>) and click Submit, your browser will POST your new idea to the server.</p>

    <p>Try posting some new ideas, then look at <a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a> again. The server will give you the list of ideas.</p>

    <h2>A pretty ideas feed</h2>

    <p>Let's add one more page to our site. This page will have some JavaScript that gets the ideas list, then makes it pretty for us to look at.</p>

    <p>As before, use Atom to create the page, paste in the code below, and save it in the <b>public</b> folder as <b>ideafeed.html</b></p>

<pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
    &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">&lt;/script>
    &lt;title>Idea Feed&lt;/title>
    &lt;style>
    /*This is the start of the CSS*/

    .idea-box {
      background-color: #FFF0A5;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #FFB03B;
    }

    h2 {
      color: #468966;
      margin: 10px;
      padding: 10px;
      border: 2px solid #FFB03B;
      border-radius: 5px;
      text-align: center;
    }

    /*end of CSS */
    &lt;/style>
  &lt;/head>
  &lt;body>
    &lt;h1 class="title">Idea Feed&lt;/h1>
    &lt;div class="idea-box">
    &lt;/div>
    &lt;script>
//Hello! This is the start of the JavaScript.

var displayIdea = function(idea) {
  var ideaElement = $('&lt;h2>' + idea + '&lt;/h2>');
  $(".idea-box").append(ideaElement);
}

var createFeed = function(data) {
  data.forEach(displayIdea);
}

$.get("/ideas", createFeed);

//This is the end of the JavaScript.
    &lt;/script>
  &lt;/body>
&lt;/html>

</code></pre>

    <p>Test your new ideas feed with this link: <a href="http://localhost:3000/ideafeed.html" target="_blank">http://localhost:3000/ideafeed.html</a></p>

    <p>The Idea Feed is a page with some JavaScript. The script will GET the raw ideas list, then go through each item in the list. <b>For each item</b>, it creates a little bit of HTML and adds it into the page. (Just like in the fivestar activity.)</p>

    <h2>That's all!</h2>

    <p><b>extra for experts:</b> Can you move the code that POSTs new ideas onto the Ideas Feed page?</p>

      <!-- end of legacy Code Club content here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; Girl Code 2015.
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visible-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    <script src="/js/contact_me.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>

</body>

</html>
