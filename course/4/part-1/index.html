<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Girl Code activities</title>

    <!-- Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/freelancer.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <link href="/js/prism/prism.css" rel="stylesheet">
    <script src="/js/prism/prism.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" class="index">

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5JFL8D"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5JFL8D');</script>
    <!-- End Google Tag Manager -->

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Girl Code</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll">
                        <a href="../">Node.js</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="intro-text">
                        <span class="name">Life on the server-side</span>
                        <span class="skills">With Node.js</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <section id="starter">
        <div class="container codeclubstyle">
            <div class="row">
                <div class="col-lg-12">

      <!-- insert legacy Code Club content here -->
      <h1>Servers</h1>

      <p>All our code so far has been client-side code. This means it is downloaded onto the user's computer, and makes things appear or happen on the user's computer.</p>

      <p>If we want to do things outside of the user's computer – like post messages for other people to read on other computers – we need to run code on the server, the computer that the website comes from.</p>

      <p>In this workshop we will set up a server using Node.js which will serve files to a client.</p>

      <h2>Setting up Node.js</h2>

      <p>Node.js (sometimes just called Node) is a server program.</p>

      <p><a href="https://nodejs.org/download/" target="_blank">Download Node</a> (choose the Windows installer or Macintosh installer) and install it.</p>

      <h2>Terminal and Command Prompt</h2>

      <p>Have you heard of the 'command line?' It's a place in your computer where you type in commands, and it was very popular until Windows came out in 1992.</p>

      <p>But the command line is still there! It's waiting for you to come back.</p>

      <h2>Find it on Windows</h2>

      <p>Press the Start button, type in "cmd" and <b>Command Prompt</b> will come up. Click on Command Prompt to start.</p>

      <h2>Find it on Mac</h2>

      <p>Open Finder, go to Applications, look in the Utilities folder and open 'Terminal'.</p>

      <p>OR: type 'Terminal' into Spotlight (the search box)</p>

      <h2>Command line commands</h2>

      <p>...todo...</p>

      <h2>Get our Node project</h2>

      <p>Go to this <a href="https://github.com/mgatland/nodestart/" target="_blank">webpage</a> where Matthew put a simple Node project. Click on 'Clone in Desktop' </p>

      <p>This will create a clone (a copy) of the project on your computer.</p>

      <p>Next, use Terminal or Command Prompt to go to that folder. (TODO: explain how...)</p>

      <h2>Running Node</h2>

      <p>To install the dependencies - all the things our program needs to work right - type <code>npm install</code> into the command prompt and hit enter. It may take a while to finish!</p>

      <p>Next, run our Node app by typing <code>node index.js</code> and hitting enter.</p>

      <p>This starts up a <b>server</b> on your computer. Open your favourite web browser (like Google Chrome) and go to <a href="http://localhost:3000/index.html" target="_blank">http://localhost:3000/index.html</a> to visit your local server.</p>

      <p>If you see an orange and purple page, it's working!</p>

      <p>Try this link too:</p>
      <p><a href="http://localhost:3000/" target="_blank">http://localhost:3000/</a></p>

      <p>It should look exactly the same. That's because, if you don't say what page you want, you automatically get index.html. Neocities follows the same rule, which is why these pages also look exactly the same:</p>

      <ul>
        <li><a href="http://mgatland.neocities.org" target="_blank">http://mgatland.neocities.org</a></li>
        <li><a href="http://mgatland.neocities.org/index.html" target="_blank">http://mgatland.neocities.org/index.html</a></li>
      </ul>

      <h2>Serving Files</h2>

      <p>The server will serve us any file we ask for, as long as it's in the public folder. Look in your nodetest folder for the public folder (using Windows Explorer or Finder on Mac) and look inside.</p>

      <p>Make a new file called <b>tvshow.html</b> in that folder and put something inside it. Then try opening this link:</p>

      <p><a href="http://localhost:3000/tvshow.html" target="_blank">http://localhost:3000/tvshow.html</a></p>

      <p>Neocities has a server a lot like this, that <b>serves</b> your pages to the web browser when you ask for them.</p>

      <p>What happens if you ask for something that's not available?</p>

      <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

      <h2>Keep that server busy</h2>

      <p>It's easy to serve pages that have already been made! But sites like Facebook, pinterest and TradeMe serve us special pages that are always changing – pages that update and change all the time.</p>

      <p>Let's tell our server, when we make a special request, it should give us a special reply.</p>

      <h2>What is the server doing so far?</h2>      

      <p><b>Open index.js in the main nodetest folder</b>. Note that this is not in the <b>public</b> folder, it's in the folder above that.</p>

      <p>This is a <b>js</b> file, which means JavaScript. There are 5 lines of code, plus some comments (lines that start with // are comments for humans to read, the computer does not read them.)</p>

      <pre><code class="language-javascript">
//set up
var express = require('express')
var app = express();

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

//listen for connections on port 3000
app.listen(3000);
console.log("I am listening...");
      </code></pre>

      <p>We don't need to understand all of those commands just yet. The main thing is, when you make a request, it looks in the public folder for a file to give you. If there is no matching file, it tells you it cannot GET that file.</p>

      <h2>Special requests</h2>

      <p>Add this code at line 8 of your index.js file:</p>

      <pre><code class="language-javascript">
app.get('/ideas', function (req, res) {
  res.send('try wearing a hat on cold days');
});
        </code></pre>

        <p>This tells the server: <b>when someone requests "ideas", Send them this special response: 'try wearing a hat on cold days'</b></p>

        <p>Now:</p>

        <ul>
            <li>Save your changes.</li> 
            <li>Go to the Command Prompt and hit Ctrl-C, Ctrl-C (twice) to <b>stop</b> the server.</li>
            <li>Then start the server again by typing <code>node index.js</code>, Enter.</li>
        </ul>
        

        <p>The server will restart with your new changes.Now try this link again:</p>

        <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

        <p>This time, you should get the special response.</p>

      <h2>GET and POST</h2>

      <p>When the user wants to look at a web page, that's called GET.</p>

      <p>When the user wants to change or save something, like a new facebook message, that's called POST. They POST the message to us, like a letter 📩</p>

      <p>Replace ALL the code in index.js with this new code. I've changed it, so that the server keeps track of a list of ideas. (Remember lists from our TV Show Idea Generator?)</p>

      <pre><code class="language-javascript">
//set up
var express = require('express')
var app = express();
var bodyParser = require('body-parser')

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

//this lets us read POST data
app.use(bodyParser.urlencoded({ extended: false }))
app.use(bodyParser.json())

//make an empty list of ideas
var ideas = [];
ideas.push('try wearing a hat on cold days'); //start with one idea

//let a client GET the list of ideas
app.get('/ideas', function (req, res) {
  res.send(ideas);
});

//let a client POST new ideas
app.post('/ideas', function (req, res) {
  console.log(req.body.idea); //write it on the command prompt so we can see
  ideas.push(req.body.idea); //save a new idea
  res.send("thanks for your idea");
});

//listen for connections on port 3000
app.listen(3000);
console.log("I am listening...");

      </code></pre>

    <p>You can test the GET by using the same link as before.</p>

    <p><a href="http://localhost:3000/ideas" target="_blank">http://localhost:3000/ideas</a></p>

    <p>Testing POST is trickier because your web browser does not normally POST.</p>

    <p>To post, make a new file called <b>test.html</b> and save it in your <b>public</b> folder. Put this code inside:</p>

<pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
    &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>    
  &lt;/head>
  &lt;body>
      &lt;form method="post" action="/ideas">
          &lt;input type="text" name="idea" value="idea goes here">
          &lt;input type="submit" value="Submit">
      &lt;/form>
  &lt;/body>
&lt;/html>
</code></pre>

    <p>Now if you go to that page (<a href="http://localhost:3000/test.html" target="_blank">http://localhost:3000/test.html</a>) and click Submit, your browser will POST your new idea to the server.</p>

    <p>Try posting some new ideas, then go back to the page that GETs the ideas. You should see a list of ideas.</p>

    <p>What's next? Including these ideas on a pretty website, instead of a plain white list.</p>

      <!-- end of legacy Code Club content here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    <div class="footer-col col-md-12">
                        <p>Our venue is provided by <a href="http://www.gridakl.co.nz/">GridAKL</a>, the innovation precint at Wynyard Quarter.</p>
                        <small>The pattern image in our header is by <a href="http://www.freepik.com/free-photos-vectors/background">Freepik</a>.</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; Girl Code 2015.
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visible-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    <script src="/js/contact_me.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>

</body>

</html>
