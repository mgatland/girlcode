<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Girl Code activities</title>

    <!-- Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/freelancer.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <link href="/js/prism/prism.css" rel="stylesheet">
    <script src="/js/prism/prism.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" class="index">

    <!-- Google Tag Manager -->
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5JFL8D"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5JFL8D');</script>
    <!-- End Google Tag Manager -->

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Girl Code</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll">
                        <a href="../">Node.js</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="intro-text">
                        <span class="name">Life on the server-side</span>
                        <span class="skills">With Node.js</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <section id="starter">
        <div class="container codeclubstyle">
            <div class="row">
                <div class="col-lg-12">

      <!-- insert legacy Code Club content here -->
      <h1>Making a Server</h1>

      <p>Until now, all our code has been <i>client-side code</i>. That means the code is downloaded onto the user's computer, and their computer runs the code.</p>

      <p>This time, we are adding some server-side code. This code is run on the server - the computer that our website comes from.</p>

      <p>In this workshop we will set up a server using Node.js which will serve files to a client.</p>

      <h2>Setting up Node.js</h2>

      <p>Node.js (called Node for short) is a server program.</p>

      <p><a href="https://nodejs.org/" target="_blank">Download Node</a> (choose the 'LTS' option, which says 'Recommended For Most Users') and install it. (Basically just click 'next' on all the pages, you don't need to change any settings.)</p>

      <div class="alert">
      <h3>Where is Node?</h3>
      <p>Unlike most programs, <b>Node will not appear in your Start Menu or Applications folder.</b></p>
      <p>There is no icon to click on. Node is hidden away. We will find it soon ðŸ™‚</p>
      </div>

      <h2>Get our project from GitHub</h2>

      <p>Go to this <a href="https://github.com/girlcodeakl/toasttoppings/" target="_blank">webpage</a> where we've put a simple Node project.</p>

      <p>Click 'Clone or download', then choose '
          in desktop' to clone the project using Github Desktop.</p>

      <img class="framed" src="clone-or-download.png"><br>

      <img class="framed" src="open-in-desktop.png">

      <p>This will create a clone (a copy) of the project on your computer. <b>Keep a note of where on your computer it was created!</b></p>

      <div class="alert">
      <p><b>WARNING!</b> You should see a pop-up asking you what folder to save the project.</p>

      <p>If you see a page like this, it is NOT working right:</p>

      <img src="github-clone-not-working.png">

      <p><b>If you see this page</b>, the Github website and GitHub Desktop are not talking to each other properly. Please check (or ask a mentor to help you check):</p>

      <ul>
          <li>Check that you are logged into the GitHub website</li>
          <li>Check that you are logged into GitHub Desktop <i>using the same account</i></li>
          <li>If it still doesn't work, close Google Chrome completely then try again.</li>
      </ul>

      </div>

      <h2>Terminal and Command Prompt</h2>

      <p>Have you heard of the 'command line?' It's a place in your computer where you type in commands, and it was very popular until Windows came out in 1992.</p>

      <p>But the command line is still in your computer! It's been waiting for you all these yearsâ€¦</p>

      <h2>What kind of computer are you using?</h2>

      <p>Click to show the instructions you want:</p>

      <button class="show-windows-btn">Windows</button>
      <button class="show-mac-btn">Mac</button>
      <button class="show-both-btn">Show me both</button>

      <div class="guide-windows">
        <h2>Find it on Windows</h2>

        <p>Press the Start button, type in "cmd" and <b>Command Prompt</b> will come up. Click on Command Prompt to start.</p>
        <img src="cmd.png">

      </div>

      <div class="guide-mac">
        <h2>Find it on Mac</h2>

        <p>Open Finder, go to Applications, look in the Utilities folder and open 'Terminal'.</p>
        <img src="terminal.png">
      </div>

      <h2>Change the color scheme</h2>

      <p>Black and white is so 90s. Watch this gif to see how to change your color scheme:</p>

      <div class="guide-windows">
        <img class="framed" src="cmd-colours.gif">
      </div>

      <div class="guide-mac">
        <img class="framed" src="terminal-colours.gif">
      </div>

      <h2>Command line commands</h2>

      <p>The command line is a lot like Finder (on Mac) or Windows Explorer. You can move from folder to folder. You can run things in the folder you are in.</p>

      <h3>What folder am I in?</h3>

      <div class="guide-windows">
        <p><b>Windows</b>: the Command Prompt always says what folder you are in.</p>
      </div>

      <div class="guide-mac">
      <p><b>Mac</b>: To check where you are, type <code>pwd</code> and hit Enter. (It's short for 'print working directory'. 'Working Directory' means the folder you are in. Print means write on the screen, not on paper!)</p>
      </div>

      <h3>What is in this folder?</h3>

      <div class="guide-windows">
        <p><b>Windows</b>: type <code>dir</code> and hit Enter. (It's short for 'directory', which is the old word for folder.)</p>
      </div>

      <div class="guide-mac">
        <p><b>Mac</b>: type <code>ls</code> and hit Enter. (It's kind of short for 'list files'.)</p>
      </div>

      <h3>How do I go into a different folder?</h3>

        <p>Type <code>cd something</code> where 'something' is the name of the folder you want to move into. This lets you go down into folders inside the current working folder.</p>
        <p><code>cd</code> is short for 'change directory'. (Directory is the old word for 'folder'.)</p>

      <div class="alert">

        <p>Protip: If the folder name has a space in it, you need to put speech marks around the whole name. This is so the command line knows that the two words are part of the same name. For example: <code>cd "My Documents"</code>. If it doesn't have a space, you don't need speechmarks.</p>
      </div>

      <p>To go up to the parent folder, type <code>cd ..</code> (that is cd, a space, then two dots)</p>

      <h2>Back to ToastToppings</h2>

      <p>Now, using your new Terminal or Command Prompt skills, change your working folder to be the <b>toasttoppings</b> folder that was just created.</p>

      <p>You'll need to use lots of <code>cd</code> commands to get there.</p>

      <div class="alert">

      <p><b>Wait, where am I going?</b></p>

      <p>You're going to the folder where you saved the project from GitHub.</p>

      <p>Don't remember? No problem. Go to GitHub Desktop, click on 'Repository' and then 'Open in Explorer' (Windows) or 'Open in Finder' (Mac). This will open Explorer or Finder in the right folder, so you can check where it is.</p>

      <img class="framed" src="github-open-folder.png">

      <p>Then, in Command Prompt or Terminal, use the <code>cd</code> command to go there.</p>

      <img class="framed" src="terminal-cd.png">

      </div>

      <p>Once you get there, type <code>dir</code> (Windows) or <code>ls</code> (Mac) and you should see a list of files including <b>index.js</b>.</p>

      <img class="framed" src="ls-in-toasttoppings-folder.png">

      <div class="alert">
        <p><b>Protip:</b> If you want to get to the right folder more quickly next time, go to GitHub Desktop, click on Repository and choose 'Open in Terminal' (mac) or 'Open in Git Shell' (windows)</p>
        <img src="open-in-terminal.png">

        <p>This will open a Terminal or Command Prompt that is already in the right folder.</p>
      </div>

      <h2>Running Node</h2>

      <p>So you should now have Terminal or Command Prompt open, and have moved to the toasttoppings folder.</p>

      <p>To install the dependencies - all the things our program needs to work right - type <code>npm install</code> into Terminal\Command Prompt and hit enter. It may take a while to finish.</p>

      <p>(How does it know what to install? It has a shopping list in the file package.json. Feel free to take a look. They're listed as 'dependencies'.)</p>

      <p>Next, run our Node app by typing <code>node index.js</code> and hitting enter.</p>

      <p>Your Terminal\Command Prompt is now busy running the server - it won't listen to any more instructions from you.</p>

      <p>This starts up a <b>server</b> on your computer. Open your favourite web browser (we like Google Chrome) and go to <a href="http://localhost:3000/index.html" target="_blank">http://localhost:3000/index.html</a> to visit your local server.</p>

      <p>If you see an orange and purple page, it's working!</p>

      <h3>URLs refresher</h3>

      <p>The link you just clicked has two parts:</p>

      <ul>
        <li><b>localhost:3000</b> is the host, or server - the computer who we want to talk to.</li>
        <li><b>/index.html</b> is the path - this says what we are asking for.</li>
      </ul>

      <div class="alert">
        <p>What if I don't include a path?</p>
        <p>Try this link: <a href="http://localhost:3000">http://localhost:3000</a></p>
        <p>It's showing us the same page!</p>
        <p>If you don't say what you want, the server gives you <b>index.html</b> because it's a good starting point.</p>
      </div>

      <h2>Serving Files</h2>

      <p>This server program is very simple. When we ask for a file, it looks in the 'toasttoppings/public' folder for that file. If it's there, it sends the file to us.</p>

      <p>The public folder is inside your toasttoppings folder. Use Windows Explorer or Finder (Mac) to look inside the public folder and see what's there.</p>

        <h2>Serve another File</h2>

        <p>Remember how we installed VS Code for the Cat Facts activity? It's a text editor. Open VS Code.</p>

        <p>VS Code works best when you open the folder you're working in. Click <b>File</b> (at the top left) then <b>Open Folderâ€¦</b> and select the ToastToppings folder, and open it.</p>

        <img class="framed" src="vs-code-open-folder.png">

        <p>This will give you a sidebar in VS Code that shows all the files in ToastToppings.</p>

        <img class="framed" src="vs-code-showing-toasttoppings.png">

        <p>Use VS Code to make a new file. (Click Fileâ€¦ New File.)</p>
        
        <p>Save the new file. Name it <b>new.html</b> and put it in the 'toasttoppings/public' folder.</p>

        <p>Put this code inside new.html and save it again.</p>

      <pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
  &lt;/head>
  &lt;body>
     &lt;h1>Hi i am a new page I guess&lt;/h1>
     &lt;h2>not gonna brag &lt;br> but i'm pretty cool&lt;/h2>
  &lt;/body>
&lt;/html>
      </code></pre>

      <p>Now our server will automatically serve this page. Click this link to ask for the new page:</p>

      <p><a href="http://localhost:3000/new.html" target="_blank">http://localhost:3000/new.html</a></p>

     <p>What happens if you ask for something that's not in the public folder?</p>

      <p><a href="http://localhost:3000/posts" target="_blank">http://localhost:3000/posts</a></p>

      <p>The server says "I can't get that page for you".</p>

      <h2>Our server is clever</h2>

      <p>It's easy to serve pages that have already been made! But sites like Facebook, pinterest and TradeMe serve us special pages that they prepared just for us â€“ custom-made pages that might include our friends' posts, or products we searched for.</p>

      <p>Let's tell our server, when we make a special request, it should give us a special reply - not just a premade page.</p>

      <h2>The server's instructions</h2>

      <p>Use VS Code to open <b>index.js</b>, a file in the  in the main <b>toasttoppings folder</b>. Note that this is not in the <b>public</b> folder, it's in the ToastToppings folder which is outside the public folder.</p>

      <p>This is a <b>js</b> file, which means JavaScript. There are 5 lines of code, plus some comments. (Lines that start with // are comments for humans to read - they have no effect on how the program works.)</p>

      <p>Your code will look exactly the same as this:</p>

      <pre><code class="language-javascript">
//set up
let express = require('express');
let app = express();

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

app.listen(3000);
console.log("Hi! I am listening at http://localhost:3000");
      </code></pre>

      <p><b>We don't need to understand all of those commands today</b>. The main thing to know is, when you make a request, it looks in the public folder for a file to give you. If there is no matching file, it tells you it cannot GET that file.</p>

      <h2>Special requests</h2>

      <p>Add this code at <b>line 8</b> of your index.js file:</p>

      <pre><code class="language-javascript">
let posts = [];

posts.push("hi what is up everybody");
posts.push("auckland is so nice in summer... and so bad in winter");
posts.push("current status: playing sports");

function sendPostsList (request, response) {
  response.send(posts);
}
app.get('/posts', sendPostsList);
        </code></pre>

        <p>Here's what this new code is doing:</p>
        <ul>
            <li>It creates a variable called <code>posts</code> which is an empty list</li>
            <li>It adds three messages to the list</li>
            <li>It creates a function <code>sendPostsList</code>. This is a command that can send the posts to the client</li>
            <li>Finally, it tells the server that when a client tries to GET "/posts", use the function <code>sendPostsList</code> to reply - this means it will reply by sending them the list of posts.</li>
        </ul>

        <p>Now:</p>

        <ul>
            <li>Save your changes.</li>
            <li>Go to the Command Prompt\Terminal and hit Ctrl-C, Ctrl-C (twice) to <b>stop</b> the server.</li>
            <li>Then start the server again by typing <code>node index.js</code>, Enter.</li>
            <li>This will make the server read your updated instructions, and start serving with the new rules.</li>
        </ul>

        <p>Now try this link again:</p>

        <p><a href="http://localhost:3000/posts" target="_blank">http://localhost:3000/posts</a></p>

        <p>This time, you should get the special response. This response isn't a pre-made file - the server created it using code.</p>

        <p><b>protip</b>: the response isn't very pretty! It's just a list on plain white background. This is because it's not really made for humans to look at.</p>

        <p>Normally, a human wouldn't GET a list like this. Instead, the web browser would GET it behind the scenes, and use it to build something that looks nice.</p>

      <h2>GET and POST</h2>

      <p>When the user wants to look at a web page, that's called GET.</p>

      <p>When the user wants to change or save something, like a new facebook message, that's called POST. It's a bit like posting a letter ðŸ“©</p>

      <p><b>Delete ALL the code in index.js</b> and replace it with this. I've changed it, so that the server lets clients add to a list. (Remember lists from our TV Show Idea Generator?)</p>

      <pre><code class="language-javascript">
//set up
let express = require('express')
let app = express();
let bodyParser = require('body-parser')

//If a client asks for a file,
//look in the public folder. If it's there, give it to them.
app.use(express.static(__dirname + '/public'));

//this lets us read POST data
app.use(bodyParser.urlencoded({ extended: false }))
app.use(bodyParser.json())

//make an empty list
let posts = [];

//let a client GET the list
function sendPostsList(request, response) {
  response.send(posts);
}
app.get('/posts', sendPostsList);

//let a client POST something new
function saveNewPost(request, response) {
  console.log(request.body.message); //write it on the command prompt so we can see
  posts.push(request.body.message); //save it in our list
  response.send("thanks for your message. Press back to add another");
}
app.post('/posts', saveNewPost);

//listen for connections on port 3000
app.listen(3000);
console.log("Hi! I am listening at http://localhost:3000");

      </code></pre>

        <p>Because we changed the server instructions, we need to:</p>

        <ul>
            <li>Save your changes.</li>
            <li>Go to the Command Prompt\Terminal and hit Ctrl-C, Ctrl-C (twice) to <b>stop</b> the server.</li>
            <li>Then start the server again by typing <code>node index.js</code>, Enter.</li>
        </ul>

    <p>You can test the GET by using the same link as before.</p>

    <p><a href="http://localhost:3000/posts" target="_blank">http://localhost:3000/posts</a></p>

    <p>This time you should see an empty list: <code>[]</code></p>

    <p>Testing POST is trickier because your web browser does not normally POST.</p>

    <p>To post, we need a page with a button on it. Use VS Code to make a new file called <b>post.html</b> and save it in your <b>public</b> folder. Put this code inside:</p>

<pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
  &lt;/head>
  &lt;body>
      &lt;form method="post" action="/posts">
          &lt;input type="text" name="message" value="message goes here">
          &lt;button>Post it!&lt;/button>
      &lt;/form>
  &lt;/body>
&lt;/html>
</code></pre>

    <p>Now if you go to that page (<a href="http://localhost:3000/post.html" target="_blank">http://localhost:3000/post.html</a>) and click "Post it!", your browser will POST your message to the server.</p>

    <p>Try posting some new posts, then look at <a href="http://localhost:3000/posts" target="_blank">http://localhost:3000/posts</a> again. The server will give you the list of messages.</p>

    <h2>A pretty message feed</h2>

    <p>Let's add one more page to our site. This page will have some JavaScript that gets the message list, then makes it pretty for us to look at.</p>

    <p>As before, use VS Code to create the page, paste in the code below, and save it in the <b>public</b> folder as <b>feed.html</b></p>

<pre><code class="language-markup">
&lt;!DOCTYPE html>
&lt;html>
  &lt;head>
    &lt;meta charset='utf-8'>
    &lt;script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">&lt;/script>
    &lt;title>Message Feed&lt;/title>
    &lt;style>
    /*This is the start of the CSS*/

    body {
      text-align: center;
    }

    .message-list {
      background-color: #FFF0A5;
      padding: 20px;
    }

    h1 {
      color: #FFB03B;
    }

    .post {
      margin: 10px;
      padding: 10px;
      border: 2px solid #FFB03B;
      border-radius: 5px;
      color: #468966;
    }

    /*end of CSS */
    &lt;/style>
  &lt;/head>
  &lt;body>
    &lt;h1 class="title">Message Feed&lt;/h1>
    &lt;div class="message-list">
    &lt;/div>
    &lt;script>
//Hello! This is the start of the JavaScript.

function displayMessage(message) {

  let postHTML = 
  '&lt;div class="post">'
  + '  &lt;div class="message">' + message + '&lt;/div>'
  + '&lt;/div>';

  let messageList = document.querySelector(".message-list");
  messageList.innerHTML += postHTML;
}

function createFeed(posts) {
  console.log(posts);
  posts.forEach(displayMessage);
}

fetch("/posts")
  .then(response => response.json())
  .then(createFeed);

//This is the end of the JavaScript.
    &lt;/script>
  &lt;/body>
&lt;/html>

</code></pre>

    <p>Test your new message feed with this link: <a href="http://localhost:3000/feed.html" target="_blank">http://localhost:3000/feed.html</a></p>

    <p>The Message Feed is a page with some JavaScript. The script will GET the raw message list, then go through each item in the list. <b>For each item</b>, it creates a little bit of HTML and adds it into the page. (Just like how we added starts in the fivestar activity.)</p>

    <p>Try posting a few more posts using <a href="http://localhost:3000/post.html" target="_blank">http://localhost:3000/post.html</a>, then coming back to the feed and refreshing it. The new posts should appear.</p>

    <h2>That's all!</h2>

    <p><b>extra for experts:</b> Can you copy the form from post.html into feed.html so you can post and read on the same page?</p>

      <!-- end of legacy Code Club content here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; Girl Code 2015.
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visible-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    <script src="/js/contact_me.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>

    <!-- tutorial specific stuff -->
    <script>
      var showWindows = function () {
        $(".guide-windows").fadeIn();
        $(".guide-mac").fadeOut();
      };
      $(".show-windows-btn").click(showWindows);

      var showMac = function () {
        $(".guide-windows").fadeOut();
        $(".guide-mac").fadeIn();
      };
      $(".show-mac-btn").click(showMac);

      var showBoth = function () {
        $(".guide-windows").fadeIn();
        $(".guide-mac").fadeIn();
      };
      $(".show-both-btn").click(showBoth);
    </script>

</body>

</html>
